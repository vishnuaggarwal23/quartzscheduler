<!DOCTYPE html>
<html layout:decorate="common/layout"
      th:lang="${lang}"
      th:with="lang=${#locale.language}"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <div layout:fragment="customCSS">
        <link rel="stylesheet" th:href="@{/webjars/select2/4.0.3/css/select2.css}" type="text/css"/>
        <link rel="stylesheet" th:href="@{/webjars/select2-bootstrap-css/1.4.6/select2-bootstrap.css}" type="text/css"/>
        <link rel="stylesheet"
              th:href="@{/webjars/Eonasdan-bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.css}"
              type="text/css"/>
    </div>
</head>

<body>
<div layout:fragment="htmlContent">
    <div class="row">
        <div class="col-md-12">
            <div class="portlet box green">
                <div class="portlet-title">
                    <div class="caption"><i class="fa fa-gift"></i>Create New Job</div>
                </div>
                <div class="portlet-body create-job-form">
                    <form class="form-horizontal"
                          id="create-job-form"
                          name="create-job-form"
                          th:attr="
                          data-create-job-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).createOrUpdateJobUri()}},
                          data-create-new-unscheduled-api-job-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).createOrUpdateJobUri()}},
                          data-create-new-simple-api-job-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).createOrUpdateJobUri()}},
                          data-create-new-cron-api-job-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).createOrUpdateJobUri()}}"
                          th:method="${T(org.springframework.http.HttpMethod).POST}">
                        <div class="form-body" id="jobDetails">
                            <h3 class="form-section">Job Info</h3>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="jobKeyName">Key Name<span
                                                aria-required="true" class="required">*</span></label>
                                        <div class="col-md-9">
                                            <input class="form-control job-key-name"
                                                   data-group-name-selector="input#jobGroupName"
                                                   data-msg-customUniqueKey="Job key already exists."
                                                   data-msg-required="Job Key Name is missing."
                                                   data-rule-customUniqueKey="true"
                                                   data-rule-required="true"
                                                   id="jobKeyName"
                                                   name="jobKeyName"
                                                   placeholder="Job Key Name"
                                                   th:attr="data-custom-unique-key-validation-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).uniqueJobKeyApiUri()}}"
                                                   type="text"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="jobGroupName">Group Name<span
                                                aria-required="true" class="required">*</span></label>
                                        <div class="col-md-9">
                                            <input class="form-control job-group-name"
                                                   data-msg-required="Job Group Name is missing."
                                                   data-rule-required="true"
                                                   id="jobGroupName"
                                                   name="jobGroupName"
                                                   placeholder="Job Group Name"
                                                   readonly="readonly"
                                                   type="text"/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="jobDescription">Description<span
                                                aria-required="true" class="required">*</span></label>
                                        <div class="col-md-9">
                                            <textarea class="form-control job-description"
                                                      cols="5"
                                                      data-msg-required="Job Description is missing."
                                                      data-rule-required="true"
                                                      id="jobDescription"
                                                      name="jobDescription"
                                                      placeholder="Job Description"
                                                      rows="10">
                                            </textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="jobType">Type<span
                                                aria-required="true"
                                                class="required">*</span></label>
                                        <div class="col-md-9">
                                            <select class="form-control job-type"
                                                    data-msg-required="Job Executor Class is missing."
                                                    data-rule-required="true"
                                                    id="jobType"
                                                    name="jobType">
                                                <option th:attr="
                                    data-enum-name=${null},
                                    data-enum-url-key=${null},
                                    data-get-fragment-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).getJobFragmentWebUri()}}"
                                                        value="">
                                                    Select
                                                </option>
                                                <option th:attr="
                                    data-enum-name=${jobType},
                                    data-enum-url-key=${jobType.getUrlKey()},
                                    data-get-fragment-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).getJobFragmentWebUri(jobType.getFragment())}}"
                                                        th:each="jobType : ${T(com.vishnu.aggarwal.core.enums.JobType).getAll()}"
                                                        th:text="${jobType}"
                                                        th:value="${jobType}">
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="jobRecovery">Recovery</label>
                                        <div class="col-md-9">
                                            <div class="checkbox-list">
                                                <label class="checkbox-inline job-recovery">
                                                    <input class="form-control"
                                                           id="jobRecovery"
                                                           name="jobRecovery"
                                                           type="checkbox"/>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="jobDurability">Durability</label>
                                        <div class="col-md-9">
                                            <div class="checkbox-list">
                                                <label class="checkbox-inline">
                                                    <input class="form-control job-durability"
                                                           id="jobDurability"
                                                           name="jobDurability"
                                                           type="checkbox"/>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="jobScheduled">Scheduled</label>
                                        <div class="col-md-9">
                                            <div class="checkbox-list">
                                                <label class="checkbox-inline">
                                                    <input class="form-control job-scheduled"
                                                           id="jobScheduled"
                                                           name="jobScheduled"
                                                           th:attr="data-trigger-new-form-fragment-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).getTriggerFragmentWebUri(TRIGGER_FORM_NEW)}},data-trigger-none-form-fragment-uri=@{${T(com.vishnu.aggarwal.core.constants.ThymeleafUrlMapping).getTriggerFragmentWebUri(TRIGGER_FORM_NONE)}}"
                                                           th:with="TRIGGER_FORM_NONE=${T(com.vishnu.aggarwal.core.constants.ApplicationConstants).FRAGMENTS_TRIGGER.get(4)},TRIGGER_FORM_NEW=${T(com.vishnu.aggarwal.core.constants.ApplicationConstants).FRAGMENTS_TRIGGER.get(3)}"
                                                           type="checkbox"/>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label th:for="jobExecutorClass" class="control-label col-md-3">Job Executor
                                            Class<span class="required"
                                                       aria-required="true">*</span></label>
                                        <div class="col-md-9">
                                            <select class="form-control job-executor-class"
                                                    data-msg-required="Job Executor Class is missing."
                                                    data-rule-required="true"
                                                    id="jobExecutorClass"
                                                    name="jobExecutorClass">
                                                <option th:attr="
                                                        data-enum-name=${null},
                                                        data-associated-http-method=${null}" th:value="${null}">Select
                                                </option>
                                                <option th:attr="
                                                        data-enum-name=${jobExecutorClass},
                                                        data-associated-http-method=${jobExecutorClass.getHttpMethod()}"
                                                        th:each="jobExecutorClass : ${T(com.vishnu.aggarwal.core.enums.JobExecutorClass).getAll()}"
                                                        th:text="${jobExecutorClass.getClassName()}"
                                                        th:value="${jobExecutorClass}">
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="job-type-fragment"></div>

                        </div>

                        <div id="trigger-form-fragment"></div>

                        <div class="form-actions">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="row">
                                        <div class="col-md-offset-3 col-md-9">
                                            <button class="btn green" type="submit">Submit</button>
                                            <button class="btn default" type="reset">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6"></div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="clearfix"></div>
</div>

<div layout:fragment="customJS">
    <script th:src="@{/webjars/select2/4.0.3/js/select2.full.js}" type="text/javascript"></script>
    <script th:src="@{/webjars/jquery-validation/1.17.0/jquery.validate.js}" type="text/javascript"></script>
    <script th:src="@{/webjars/jquery-validation/1.17.0/additional-methods.js}" type="text/javascript"></script>
    <script th:src="@{/webjars/momentjs/2.21.0/moment.js}" type="text/javascript"></script>
    <script th:src="@{/webjars/momentjs/2.21.0/min/moment-with-locales.js}" type="text/javascript"></script>
    <script th:src="@{/webjars/bootstrap/3.3.7/js/transition.js}" type="text/javascript"></script>
    <script th:src="@{/webjars/bootstrap/3.3.7/js/collapse.js}" type="text/javascript"></script>
    <script th:src="@{/webjars/Eonasdan-bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.js}"
            type="text/javascript"></script>
    <script th:src="@{/common/js/components-date-time-pickers.js}" type="text/javascript"></script>
    <script th:src="@{/quartz/job/js/create.js}" type="text/javascript"></script>
</div>
</body>
</html>